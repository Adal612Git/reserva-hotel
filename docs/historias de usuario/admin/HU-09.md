# HU-09: Eliminar (o desactivar) una habitaciÃ³n

---

## ğŸ“ Historia de Usuario

**Como** administrador del sistema,  
**quiero** poder desactivar (o eliminar lÃ³gicamente) una habitaciÃ³n,  
**para** que no estÃ© disponible para nuevas reservas sin afectar el historial ni los registros ya existentes.

---

## ğŸ“Œ Estatus  
âœ… Pendiente de desarrollo

---

## ğŸ¯ PriorizaciÃ³n  
Media â€” No bloquea flujos principales, pero es importante para el mantenimiento del sistema.

---

## ğŸ‘¤ Actor Principal  
Administrador (usuario autenticado con rol autorizado)

---

## ğŸ”— RelaciÃ³n con otras historias de usuario

- **HU-08**: Crear una habitaciÃ³n  
- **HU-16**: Editar habitaciÃ³n existente  
- **HU-06**: Ver habitaciones disponibles (ya no debe mostrar habitaciones desactivadas)  
- **HU-03**: Crear nueva reserva (debe validar que la habitaciÃ³n estÃ© activa)

---

## ğŸ§± Requisitos Previos / Dependencias TÃ©cnicas

- Sistema de autenticaciÃ³n con protecciÃ³n por rol (HT-03)
- Endpoint `PUT /api/habitaciones/:id/desactivar` o `DELETE /api/habitaciones/:id`
- Flag en la base de datos para activar/desactivar (`activa: true/false`)
- Vista de gestiÃ³n de habitaciones para seleccionar y desactivar

---

## âœ… Criterios de AceptaciÃ³n

### ğŸ¯ Criterio 1: AcciÃ³n restringida
- [ ] Solo usuarios con rol `admin` pueden eliminar o desactivar habitaciones.
- [ ] Se debe confirmar la acciÃ³n con un mensaje:  
  > â€œÂ¿EstÃ¡s seguro de que deseas desactivar esta habitaciÃ³n?â€

### ğŸ¯ Criterio 2: DesactivaciÃ³n lÃ³gica
- [ ] El sistema debe cambiar el estado de la habitaciÃ³n a `activa: false`.
- [ ] No debe eliminar fÃ­sicamente el registro de la base de datos.

### ğŸ¯ Criterio 3: ExclusiÃ³n en flujos operativos
- [ ] Habitaciones desactivadas no deben aparecer en:
  - Listados pÃºblicos
  - Buscador de disponibilidad (HU-06)
  - Formulario de reservas (HU-03)

### ğŸ¯ Criterio 4: Visibilidad en panel admin
- [ ] En el panel de gestiÃ³n de habitaciones:
  - Las desactivadas deben estar visibles (opcionalmente filtrables)
  - Debe poder reactivarse una habitaciÃ³n con un clic

---

## ğŸ”„ Flujo BÃ¡sico

1. Administrador accede al panel de habitaciones.
2. Selecciona una habitaciÃ³n activa.
3. Hace clic en â€œDesactivarâ€ o â€œEliminarâ€.
4. El sistema:
   - Confirma la acciÃ³n
   - Cambia el campo `activa` a `false`
5. La habitaciÃ³n ya no aparece en buscadores ni formularios pÃºblicos.
6. Sigue disponible para consultar historial o estadÃ­sticas.

---

## ğŸ“‰ Flujos Alternativos

### âŒ HabitaciÃ³n ya desactivada
- Mostrar: â€œEsta habitaciÃ³n ya se encuentra desactivadaâ€

### âŒ Usuario no autorizado
- Mostrar error 403 o redirigir

---

## ğŸ”’ Validaciones de Seguridad

- Middleware de rol `admin`
- ValidaciÃ³n del ID de la habitaciÃ³n en backend
- Proteger contra eliminaciÃ³n fÃ­sica si la habitaciÃ³n tiene:
  - Reservas activas
  - Historial vinculado
- Registro de auditorÃ­a opcional: quiÃ©n desactivÃ³, cuÃ¡ndo y por quÃ©

---

## ğŸ§ª Escenarios de prueba

### âœ”ï¸ DesactivaciÃ³n correcta
```gherkin
Dado que el administrador accede a una habitaciÃ³n activa
Cuando hace clic en â€œDesactivarâ€ y confirma
Entonces la habitaciÃ³n debe quedar inactiva y no debe ser visible para reservas
